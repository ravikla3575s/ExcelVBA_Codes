# 医薬品名比較ツール

## 概要
このプロジェクトは医薬品名を比較し、医薬品コードから医薬品名を検索するための Excel VBA ツールです。

## フォルダ構成
- `src/` - ソースコードファイル（.bas）と最新の Excel マクロファイル
- `backup/` - 過去のバージョンの Excel マクロファイル

## 主要ファイル
- `DrugNameConverter.bas` - メインのユーザーインターフェース機能と実行関数
- `DrugNameParser.bas` - 医薬品名の解析機能
- `MainModule.bas` - 医薬品名比較と検索のコア機能
- `StringUtils.bas` - 文字列処理のユーティリティ関数
- `ShelfManager.bas` - 棚管理のユーティリティ機能

## 使用方法
1. Excel を開き、VBA エディタで「Microsoft Forms 2.0 Object Library」への参照を有効にします。
2. 医薬品コードシート（シート3）に医薬品名とコードを入力します。
   - F列: 医薬品名
   - G列: 医薬品コード（0から始まる14桁）
   - H列: 包装コード（1から始まる14桁）
   - I列: 販売コード（2から始まる14桁）
3. 設定シート（シート1）のB4セルで包装形態を選択します。
   - バラ包装: 「バラ」と「調剤用」の包装単位で検索
   - 分包品: 「PTP」「分包」「SP」「包装小」「PTP(患者用)」の包装単位で検索
4. 設定シート（シート1）のA7以降に医薬品コードを入力します。
   - コードは自動的に14桁に整形されます。
5. メニューから「ツール」→「マクロ」を選択し、「ProcessDrugCodesAndCompare」を実行します。

## 特徴
- 進捗バー表示機能によりリアルタイムで処理状況を確認可能
- 医薬品コードの自動整形（14桁）
- 医薬品名の包装規格考慮（例：0.5g/包、5mL）
- 複数の包装単位での一括処理
- 結果のまとめ表示

## 最終更新日
2024年3月22日 